<!DOCTYPE HTML>
<html>
<head>
<script src="canvasjs.min.js"></script>
<script type="text/javascript">

window.onload=function(){
var chart1 = new CanvasJS.Chart("chartContainer1", {
  theme: "theme2",
  title: {
    text: "Left Eye Gaze Data 2D X"
  },
  data: [
    {
      type: "line",
      dataPoints: []
    }
  ]
}); 

//-- Event handler for the input tag
var inputElement = document.getElementById("input");
inputElement.addEventListener("change", handleFiles, false);

function handleFiles() {
  var fileList = this.files;
  var reader = new FileReader();

  setInterval(function() {
    reader.readAsText(fileList[0]);
    reader.onload = function() {
      renderChart1(reader);
      renderChart2(reader);
    }
  }, 1000);
}

function renderChart1(reader) {
  var dpsList = reader.result;  
  var dps = [], dataPoint;
  
  dpsList = dpsList.split("\n");
  
  for(var i = 0; i < dpsList.length; i++) {
  	dataPoint = parseFloat(dpsList[i].split(" ")[0]);

    dps.push({ y: dataPoint });
  }
  chart1.options.data[0].dataPoints = dps;
  chart1.render();
}

var chart2 = new CanvasJS.Chart("chartContainer2", {
  theme: "theme2",
  title: {
    text: "Left Eye Gaze Data 2D Y"
  },
  data: [
    {
      type: "line",
      dataPoints: []
    }
  ]
}); 

function renderChart2(reader) {
  var dpsList = reader.result;  
  var dps = [], dataPoint;
  
  dpsList = dpsList.split("\n");
  
  for(var i = 0; i < dpsList.length; i++) {
  	dataPoint = parseFloat(dpsList[i].split(" ")[1]);

    dps.push({ y: dataPoint });
  }
  chart2.options.data[0].dataPoints = dps;
  chart2.render();
}
</script>

  
</head>

<body>
<input type="file" id="input">
<div id="chartContainer1" style="height: 360px; width: 100%;"></div>
<div id="chartContainer2" style="height: 360px; width: 100%;"></div>
  
  <script>
  // tell the embed parent frame the height of the content
  if (window.parent && window.parent.parent){
    window.parent.parent.postMessage(["resultsFrame", {
      height: document.body.getBoundingClientRect().height,
      slug: "a9ks2w43"
    }], "*")
  }
</script>

</body>

</html>

